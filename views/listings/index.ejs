<% layout("/layouts/boilerplate") %>

  <!-- <h2>All Listings</h2> -->
  <!-- <form action="/listings/new" method="get">
    <button class="add">Add New List</button>
  </form> -->
  <div id="filters">
    <div class="filter-types">
      <div class="filter" data-category="heritage">
        <i class="fa-solid fa-torii-gate"></i>
        <p>Heritage</p>
      </div>
      <div class="filter" data-category="mountains">
        <i class="fa-solid fa-mountain"></i>
        <p>Mountains</p>
      </div>
      <div class="filter" data-category="lakes">
        <i class="fa-solid fa-water"></i>
        <p>Lakes</p>
      </div>
      <div class="filter" data-category="trending">
        <i class="fa-solid fa-fire"></i>
        <p>Trending</p>
      </div>
      <div class="filter" data-category="rooms">
        <i class="fa-solid fa-bed"></i>
        <p>Rooms</p>
      </div>
      <div class="filter" data-category="cities">
        <i class="fa-solid fa-mountain-city"></i>
        <p>Iconic Cities</p>
      </div>

      <div class="filter" data-category="swimming-pools">
        <i class="fa-solid fa-person-swimming"></i>
        <p>Swimming Pools</p>
      </div>
      <div class="filter" data-category="camping">
        <i class="fa-solid fa-campground"></i>
        <p>Camping</p>
      </div>
      <div class="filter" data-category="farms">
        <i class="fa-solid fa-cow"></i>
        <p>Farms</p>
      </div>
      <div class="filter" data-category="arctic">
        <i class="fa-solid fa-snowflake"></i>
        <p>Arctic</p>
      </div>
      <div class="filter" data-category="spiritual">
        <i class="fa-solid fa-book-bible"></i>
        <p>Spiritual</p>
      </div>

      <div class="filter" data-category="desert">
        <i class="fa-solid fa-mountain-sun"></i>
        <p>Desert</p>
      </div>

    </div>

    <div class="tax-toggle">
      <div class="form-check-reverse form-switch">
        <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault" />
        <label class="form-check-label effect" for="switchCheckDefault">
          Total Price
        </label>
      </div>
    </div>
  </div>

  <p class="note">&ast;<i>Note</i>:Price reflect the average rates of nearby hotels. </p>

  <div class="row">
    <div class="listings-container">
      <% for (const list of lists) { %>
        <a href="/listings/<%= list._id %>">
          <div class="card listing-card" style="width: 12rem">
            <img src="<%= list.image.url %>" class="card-img-top" alt="image" style="height: 12rem" />
            <div class="card-body">
              <h6 class="card-title">
                <%= list.title %>
              </h6>
              <p class="card-text">
                &#8377;<%= list.price.toLocaleString() %>
                  <i class="tax-info">&nbsp;+18% GST</i>
              </p>
            </div>
          </div>
        </a>
        <% } %>
    </div>
    <p class="more">A lot to be Added Soon...</p>
  </div>

  <!-- <script>
  let taxSwitch = document.getElementById("switchCheckDefault");
  taxSwitch.addEventListener("click", () => {
    let taxInfo = document.getElementsByClassName("tax-info");
    for (info of taxInfo) {
      if (info.style.display != "inline") info.style.display = "inline";
      else info.style.display = "none";
    }
  });
</script> -->

  <script>
    // Get the switch
    let taxSwitch = document.getElementById("switchCheckDefault");

    // Listen for a "change" event (more reliable than "click")
    taxSwitch.addEventListener("change", function () {

      // Get all the tax elements
      let allTaxInfo = document.getElementsByClassName("tax-info");

      // Check if the switch is now ON
      if (this.checked) {
        // Switch is ON: Show all tax elements
        for (let info of allTaxInfo) {
          info.style.display = "inline";
        }
      } else {
        // Switch is OFF: Hide all tax elements
        for (let info of allTaxInfo) {
          info.style.display = "none";
        }
      }
    });

    document.querySelectorAll(".filter").forEach(filter => {
      filter.addEventListener("click", () => {
        const category = filter.dataset.category;
        window.location.href = `/listings?category=${category}`;
      });
    });
    
    let inp = document.querySelector(".search-inp")
    let form = document.querySelector(".search-form");
    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const location = inp.value.trim();
      // if (!location) return;
      window.location.href = `/listings?location=${location}`
    })

  </script>